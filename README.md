
## Web Origin 漏扫

### 介绍

Web Origin目前支持10个通用漏洞扫描的脚本， 并在[皮卡丘靶机](https://github.com/zhuifengshaonianhanlu/pikachu)上通过了测试。
支持的漏洞如下

- [x] XSS 跨站脚本注入
- [x] CSRF 跨站伪造请求
- [x] SSRF 服务端请求伪造
- [x] 暴力破解 
- [x] 任意文件包含
- [x] 任意文件上传
- [x] 任意文件下载
- [x] 远程命令注入
- [x] URL重定向
- [ ] SQL注入    （封装的sqlmap api，需要用户自己配置一下）
- [x] 敏感信息泄漏

但很多脚本的playload还不够完善，估计只能应付些简单的场景。

除了通用漏洞，很多的组件的漏洞也没有收集起来，这个得依赖平时的积累了，没错，安全很吃经验。

### 定位及优势
想入门Web安全的小伙伴以及想深入了解Web漏洞扫描背后原理的同学～

它的特点如下：🏴‍☠️🏴‍☠️🏴‍☠️

1. 可以**自定义和管理**漏洞扫描脚本，用户可以通过收集或是编写漏洞扫描脚本，拥有属于自己的漏洞管理库！

2. 可以**选择性**针对某些特定的漏洞进行扫描，减去了重复扫描的造成的资源浪费

   > 场景一：不涉及数据库操作的网页，就不采用SQL检测这类高延迟扫描
   >
   > 场景二：新的漏洞出现后，用户可自定义脚本来专门扫描该漏洞，提高效率

3. 可以**查看和更改**漏洞的检测逻辑，以完善已有的漏洞检测脚本，并且获知这个脚本的检测能力范围  

   > 场景：支不支持字符串绕过，扩充脚本的检测范围，学习某种漏洞的检测方法

从某种角度而言，也算是一个随着个人Web安全实力增长而变强的法器呢 😁


> 碎碎念：
> 其实还有很多可以优化的点，比如爬虫，采用模拟点击+拦截的方法来获得发送的请求，，，之前在某大厂的安全部门实习做了Web漏洞扫描的优化，发现我自己写的工具还是有很多可以改进的点的哈哈,还想做一个规则分享功能，让大家可以搜索其他人的漏洞扫描脚本或是分享自己的漏洞扫描脚本，但还不知道使用的人多不多，如果人数多的话，就尝试做做这个功能吧，喜欢该软件的也可以点个🌟呀，嘿嘿🤤

### 本地编译
```sh
Nodejs v22.13.1
vue3
Chrome本地浏览器（默认安装路径即可）
```
用electron+vue写的,直接运行的方式如下

```sh
npm install --force
npm run vbuild
npm run estart
```

然后通过如下方式生成本地机器环境的安装包，该安装包位于out目录下

```sh
#npx electron-forge import
npm run make
```

### 安装包

在[release](https://github.com/LittleAlen/OriginWebScan/releases)页面，由于没有签名，对于Windows应用直接点击允许就好，对于MaC应用，需要移除对app的签名检查，否则会提示文件损坏。先进入到origin.app所在目录，然后执行以下命令即可
```sh
# 终端中运行（需管理员权限）
sudo xattr -rd com.apple.quarantine origin.app
```

### 界面展示



#### 主页面

- 扫描网站的URL设置
- 剪切板/文件导入原始的请求 （可带cookie）
- 导出扫描结果
- 启动/停止扫描

![image-20241213172613969](./image/image-20241213172613969.png)

#### 配置页面

- 漏洞规则的增删改查

- 启动/禁用某个漏洞规则

- 单页/全站扫描   即爬虫是否要递归爬取网页

- 动态/静态渲染   即爬虫爬取网页的过程中是否启用浏览器渲染页面

  

![image-20241213172708207](./image/image-20241213172708207.png)

#### 源代码界面

- 实时编辑源代码并保存
- resource 文件夹可上传其他大佬的程序以便封装调用，它和scripts在同一级目录

![image-20241213172721894](./image/image-20241213172721894.png)

#### 运行输出界面

- 单纯的为了方便调试自己上传的漏洞扫描脚本

![image-20241213172827967](./image/image-20241213172827967.png)





#### 关于页面

- 最初始的页面，第一次接触electron的时候，写了一个测试的页面，熟悉了一下交互逻辑，现在是作为简要的介绍

![image-20241213172937434](./image/image-20241213172937434.png)
